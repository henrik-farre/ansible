---
- name: Ensure that the ~/.config/conky directory exists
  file:
    path: "{{ ansible_user_dir }}/.config/conky"
    owner: "{{ ansible_user_id }}"
    state: directory
    mode: 0700
  tags:
    - conky

- name: Write ~/.config/conky/conkyrc
  template:
    src: conkyrc.j2
    dest: "{{ ansible_user_dir }}/.config/conky/conkyrc"
    owner: "{{ ansible_user_id }}"
    mode: 0644
  tags:
    - conky

- block:
  - name: Download and extract FontAwesome 4.7
    unarchive:
      src: http://fontawesome.io/assets/font-awesome-4.7.0.zip
      dest: "/tmp/"
      remote_src: True
    tags:
      - conky

  - name: Install FontAwesome
    copy:
      src: "/tmp/font-awesome-4.7.0/fonts/fontawesome-webfont.ttf"
      dest: "{{ ansible_user_dir }}/.fonts/fontawesome-webfont.ttf"
      remote_src: yes
    notify:
      - Update font cache
    tags:
      - conky

  always:
  - name: Cleanup
    file:
      path: /tmp/font-awesome-4.7.0
      state: absent
    tags:
      - conky
