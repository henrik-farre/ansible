---
- name: Install packages
  become: yes
  pacman:
    name: "{{ item }}"
    update_cache: yes
    state: latest
  with_items:
    - ack
    - adwaita-icon-theme
    - alsa-lib
    - alsa-tools
    - alsa-utils
    - android-tools
    - android-udev
    - ansible
    - aspell
    - autoconf
    - automake
    - bash
    - bind-tools
    - binutils
    - bridge-utils
    - bzip2
    - cantarell-fonts
    - cifs-utils
    - cmake
    - composer
#    - conky
    - cronie
    - curl
    - dkms
    - dnsmasq
    - docker
    - docker-compose
    - dosfstools
    - e2fsprogs
    - efibootmgr
    - efivar
    - evince
    - fakeroot
    - firefox
    - flashplugin
    - fontconfig
    - fping
    - fuse
    - fzf
    - gcc
    - gimp
    - git
    - gnome-calculator
    - gnome-desktop
    - gnome-icon-theme
    - gnome-icon-theme-symbolic
    - gnome-keyring
    - gnome-themes-standard
    - gnu-netcat
    - gnupg
    - gnuplot
    - google-chrome
    - gst-plugins-base
    - gst-plugins-base-libs
    - gst-plugins-good
    - gstreamer
    - gstreamer0.10
    - gstreamer0.10-base
    - gstreamer0.10-base-plugins
    - gthumb
    - gtk3-print-backends
    - gtkspell
    - gtkspell3
    - gzip
    - hicolor-icon-theme
    - htop
    - hunspell
    - icedtea-web
    - imagemagick
    - inetutils
    - intel-ucode
    - ipmitool
    - iproute2
    - iptables
    - iputils
    - lftp
    - light-locker
    - lightdm
    - lightdm-gtk-greeter
    - linux
    - linux-api-headers
    - linux-firmware
    - logrotate
    - neovim
    - network-manager-applet
    - networkmanager
    - nm-connection-editor
    - nodejs
    - npm
    - ntp
    - openssh
    - package-query
    - pam
    - pambase
    - parted
    - pciutils
    - phantomjs
    - php
    - pinentry
    - pkg-config
    - powerline-common
    - powerline-fonts
    - pv
    - pwgen
    - rrdtool
    - rsync
    - ruby
    - run-parts
    - s-nail
    - seahorse
    - sshfs
    - sshpass
    - ssmtp
    - startup-notification
    - subversion
    - sudo
    - sysfsutils
    - termite
    - termite-terminfo
    - the_silver_searcher
    - thunar
    - thunar-volman
    - tmux
    - traceroute
    - tree
    - ttf-dejavu
    - unzip
    - usb_modeswitch
    - vagrant
    - vagrant-substrate
    - virtualbox
    - virtualbox-ext-oracle
    - virtualbox-guest-iso
    - virtualbox-host-dkms
    - wget
    - wireless_tools
    - wireshark-cli
    - wireshark-common
    - wireshark-gtk
    - wmctrl
    - wpa_supplicant
    - xdg-utils
    - xdotool
    - xfce4-appfinder
    - xfce4-datetime-plugin
    - xfce4-mixer
    - xfce4-notifyd
    - xfce4-panel
    - xfce4-power-manager
    - xfce4-screenshooter
    - xfce4-session
    - xfce4-settings
    - xfconf
    - xfdesktop
    - xfwm4
    - xfwm4-themes
    - xkeyboard-config
    - xsel
    - xterm
    - xz
    - zenity
    - zim
    - zip
    - zsh

- name: Build yaourt, clone package-query
  git:
    repo: https://aur.archlinux.org/package-query.git
    dest: ~/tmp/package-queue
  delegate_to: localhost
  tags:
    - yaourt

- name: Build yaourt, makepkg
  command: makepkg -si
  args:
    chdir: ~/tmp/package-queue
  delegate_to: localhost
  register: aur_makepkg_result
  tags:
    - yaourt

- name: Build yaourt, install package-query
  become: yes
  command: pacman -U "{{ item }}" --noconfirm --noprogressbar
  with_fileglob:
    - ~/tmp/package-queue/package-query-*-x86_64.pkg.tar.xz
  delegate_to: localhost
  when:
    - aur_makepkg_result|succeeded
  tags:
    - yaourt

- name: Build yaourt, clone yaourt
  git:
    repo: https://aur.archlinux.org/yaourt.git
    dest: ~/tmp/yaourt
  delegate_to: localhost
  tags:
    - yaourt

- name: Build yaourt
  command: makepkg -si
  args:
    chdir: ~/tmp/yaourt
  delegate_to: localhost
  register: aur_makepkg_result
  tags:
    - yaourt

- name: Build yaourt, install yaourt
  become: yes
  command: pacman -U "{{ item }}" --noconfirm --noprogressbar
  with_fileglob:
    - ~/tmp/yaourt/yaourt-*-x86_64.pkg.tar.xz
  delegate_to: localhost
  when:
    - aur_makepkg_result|succeeded
  tags:
    - yaourt

- name: Install packages from community
  become: yes
  command: yaourt -S --noconfirm "{{ item }}"
  with_items:
    - xcape
    - ctags-php
    - kupfer
    - shellcheck
    - yamllint
  tags:
    - yaourt
