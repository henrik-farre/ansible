---
- name: Ensure lm_sensors is installed
  become: true
  community.general.pacman:
    name: lm_sensors
    state: latest
  tags:
    - sensors

- name: Ensure modules for current motherboard are loaded
  become: true
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "/etc/modules-load.d/"
  with_fileglob:
    - "etc/modules-load.d/{{ ansible_facts.facter_dmi.board.product|replace(' ', '_') }}.conf"
  tags:
    - sensors

- name: Ensure custom sensors config for current motherboard is installed
  become: true
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "/etc/sensors.d/"
  with_fileglob:
    - "etc/sensors.d/{{ ansible_facts.facter_dmi.board.product|replace(' ', '_') }}.conf"
  tags:
    - sensors
