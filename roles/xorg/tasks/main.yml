---
- name: Ensure need packages for xorg is installed
  include_role:
    name: package-group
  vars:
    package_group: xorg

- name: Setup keyboard
  become: yes
  copy:
    src: etc/X11/xorg.conf.d/20-keyboard.conf
    dest: /etc/X11/xorg.conf.d/20-keyboard.conf
    owner: root
    group: root
    mode: 0644
  tags:
    - xorg

- name: Install Intel video driver
  become: yes
  pacman:
    name: ["xf86-video-intel", "libva-intel-driver", "libva-vdpau-driver", "libvdpau-va-gl"]
    update_cache: yes
    state: latest
  when:
    - ansible_local.hardware.vga_vendor == "Intel Corporation"
  tags:
    - xorg

- name: Install Nvidia video driver
  become: yes
  pacman:
    name: ["nvidia-dkms", "libvdpau", "nvidia-settings", "nvidia-utils"]
    update_cache: yes
    state: latest
  when:
    - ansible_local.hardware.vga_vendor == "NVIDIA Corporation"
  tags:
    - xorg
